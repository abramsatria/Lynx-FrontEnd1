import{Q as l}from"./qrcode.vue.esm-78me3-hB.js";import{_ as m,g as d,a as b,l as h,r,o as f,c as _,b as s,d as n,t as p,w as y}from"./index-x0cUaSJO.js";const k={props:[],components:{QrcodeVue:l},data(){return{popups:d(),account:b(),about:h(),totp:{secret:"",uri:""},token:"",response:""}},methods:{async getSecret(){const e=await this.account.fetch("/auth/totp",{method:"GET"});e.success?(this.totp=e.result,this.about.track("Enabled 2FA")):this.popups.addPopup("Information",{title:"Error setting up 2FA",description:e.message,buttons:[{name:"Cancel",type:"primary",action:"close-all"}]})},async verify(){const e=await this.account.fetch("/auth/totp",{method:"POST",body:JSON.stringify({token:this.token})});e.success?(this.popups.addPopup("BackupCodes",e.result),this.account.getAccount()):this.response=e.message}},async mounted(){this.getSecret()}},v={class:"enableTOTP"},g={class:"totpSecret"};function S(e,o,A,T,t,u){const c=r("qrcode-vue"),a=r("FormKit");return f(),_("div",v,[o[1]||(o[1]=s("h2",null,"Enable 2FA",-1)),n(c,{value:t.totp.uri,level:"L"},null,8,["value"]),s("p",g,p(t.totp.secret),1),n(a,{type:"form","submit-label":"Verify Token","submit-attrs":{"button-type":"primary"},onSubmit:u.verify},{default:y(()=>[n(a,{type:"text",label:"Your 2FA token",modelValue:t.token,"onUpdate:modelValue":o[0]||(o[0]=i=>t.token=i),validation:"number:required|length:6,6",autocomplete:"one-time-code"},null,8,["modelValue"]),s("p",null,p(t.response),1)]),_:1},8,["onSubmit"])])}const F=m(k,[["render",S],["__scopeId","data-v-8d2b8938"]]);export{F as default};
