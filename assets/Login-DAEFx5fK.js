import{_ as p,l as m,g,a as c,c as l,b as a,d as n,w as h,r as b,o as u,e as f,f as i,t as y}from"./index-x0cUaSJO.js";const k={data(){return{about:m(),popups:g(),logindata:{username:"",password:"",token:""},response:null,requires2FA:!1}},mounted(){this.about.data.demo&&(this.logindata={username:"demo",password:"demo"})},methods:{async login(){this.response=null;const e=await c().login(this.logindata);if(e.success){if(this.about.track("Logged In"),this.response="Logged in!",await this.about.load(),this.$route.query.next)return this.$router.push(decodeURIComponent(this.$route.query.next));this.$router.push("/dash")}else this.requires2FA=e.message==="2FA token required",this.requires2FA||(this.response=e.message)},gotoRegister(){this.$router.push({path:"/dash/register",query:this.$route.query})},lostTOTP(){this.popups.addPopup("LostTOTP",this.logindata)}}},q={class:"login"};function V(d,e,w,T,t,s){const r=b("FormKit");return u(),l("div",q,[e[5]||(e[5]=a("h2",null,"Login",-1)),n(r,{type:"form","submit-label":"Login","submit-attrs":{"button-type":"primary"},onSubmit:s.login},{default:h(()=>[n(r,{modelValue:t.logindata.username,"onUpdate:modelValue":e[0]||(e[0]=o=>t.logindata.username=o),type:"text",label:"Your username",validation:"required:trim",autocomplete:"username"},null,8,["modelValue"]),n(r,{modelValue:t.logindata.password,"onUpdate:modelValue":e[1]||(e[1]=o=>t.logindata.password=o),type:"password",label:"Your password",validation:"required:trim",autocomplete:"current-password"},null,8,["modelValue"]),t.requires2FA?(u(),f(r,{key:0,modelValue:t.logindata.token,"onUpdate:modelValue":e[2]||(e[2]=o=>t.logindata.token=o),type:"text",label:"Your 2FA token",validation:"number:required|length:6,6",autocomplete:"one-time-code"},null,8,["modelValue"])):i("",!0),t.requires2FA?(u(),l("a",{key:1,class:"lostTOTP",onClick:e[3]||(e[3]=(...o)=>s.lostTOTP&&s.lostTOTP(...o))},"Lost your authenticator?")):i("",!0),a("p",null,y(t.response),1)]),_:1},8,["onSubmit"]),a("a",{onClick:e[4]||(e[4]=(...o)=>s.gotoRegister&&s.gotoRegister(...o))}," Register ")])}const F=p(k,[["render",V],["__scopeId","data-v-4b58399f"]]);export{F as default};
