import{_ as w,g as b,a as L,l as x,C as V,c as u,b as e,d as r,h as k,m as y,F as g,i as f,f as m,k as M,p as S,q as D,s as c,t as p,x as T,r as z,y as E,o as d,e as I}from"./index-x0cUaSJO.js";import{u as B}from"./links-CwZHDahQ.js";const H={data(){return{popups:b(),links:B(),account:L(),about:x(),endVisible:!0,loadingMore:!1,search:{timeout:null,value:""},refreshSpinning:!0,sortOptions:{author:"Author",creationDate:"Creation Date",slug:"Slug",destination:"Destination",visits:"Visits"},userFilterValue:"",users:[]}},watch:{"search.value":function(){this.refreshSpinning=!0,clearTimeout(this.search.timeout),this.search.timeout=setTimeout(this.createSearch,500)},userFilterValue(){this.links.clear(),this.loadMore()},"links.sort.field":function(){this.applySort()},"links.sort.type":function(){this.applySort()}},mounted(){if(this.loadMore(),this.$refs.refreshButton.$el.addEventListener("animationiteration",()=>{this.loadingMore===!1&&(this.refreshSpinning=!1)}),this.$route.query.edit){const o={...this.$route.query},s=o.edit;this.handleEdit({id:s}),delete o.edit,this.$router.replace({query:o})}},methods:{async loadMore(){this.loadingMore||(this.loadingMore=!0,this.refreshSpinning=!0,await this.links.paginate({search:this.search.value,userID:this.userFilterValue}),this.loadingMore=!1,this.endVisible&&this.links.remainingPages!==0&&this.loadMore())},async createLink(){this.newLink.data.error=null;const{slug:o,destination:s}=this.newLink.data,h=await this.links.create({slug:o,destination:s});h.success?this.newLink.response=h.result.link:this.newLink.data.error=h.message},copyLink(o,s){const h=`${this.about.data.domain||window.location.origin}/${s}`;if(navigator.clipboard)navigator.clipboard.writeText(h);else{const n=document.createElement("textarea");n.value=h,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select(),document.execCommand("copy"),document.body.removeChild(n)}const v=document.createElement("div");v.className="tooltip copy-link",v.innerText="Copied!",o.currentTarget.appendChild(v),setTimeout(()=>{o.target.removeChild(v)},2e3)},async getUsers(){const o=await this.account.fetch("/user/list",{});o.success?this.users=o.result:this.popups.addPopup("Information",{title:"Error getting list of users",description:o.message,buttons:[{name:"Retry",type:"primary",action:"refresh"},{name:"Cancel",type:"secondary",actions:["navigate-home","return"]}]})},handleEdit(o){this.popups.addPopup("EditLink",{id:o.id})},handleDelete(o){this.popups.addPopup("DeleteLink",o)},importLinks(){this.popups.addPopup("Import-Service")},exportLinks(){this.popups.addPopup("Export")},visibilityChanged(o){this.endVisible=o,!this.loadingMore&&o&&this.links.remainingPages>0&&this.loadMore()},toggleSelection(o){this.links.selectedLinks.includes(o.id)?this.links.selectedLinks=this.links.selectedLinks.filter(s=>s!==o.id):this.links.selectedLinks.push(o.id)},openQRCode(o){this.popups.addPopup("Information",{title:`QRCode for ${o.slug}`,qrcode:`${window.location.origin}/${o.slug}`,buttons:[{name:"Okay",type:"primary",action:"return"}]})},showContextMenu(o,s){o.preventDefault(),V.showContextMenu({x:o.x,y:o.y,items:[{label:"Edit",svgIcon:"#icon-pencil",onClick:()=>{this.handleEdit(s)}},{label:"Get QRCode",svgIcon:"#icon-qr-code",onClick:()=>{this.openQRCode(s)}},{label:"Delete",svgIcon:"#icon-trash-can",onClick:()=>{this.handleDelete([s.id])}}]})},createSearch(){this.links.clear(),this.loadMore()},refresh(){this.links.clear(),this.loadMore()},toggleSort(o){const s=this.links.sort.field!==o;if(this.links.sort.field=o,s){this.links.sort.type=-1;return}this.links.sort.type*=-1},applySort(){this.links.clear(),this.loadMore()}}},F={class:"overview",ref:"overview"},P={class:"header"},q={class:"actions"},A={class:"icon refresh"},N={key:0,class:"custom userFilter"},O={class:"userList"},R=["data-empty"],U=["value"],Q={class:"sort"},_=["value"],j=["sortType"],G={class:"links"},J=["sortType"],K=["sortType"],W=["sortType"],X=["sortType"],Y=["sortType"],Z=["selected","onClick"],$={class:"author"},ss={class:"date"},es={class:"slug"},ts=["href"],ns=["onClick"],os={class:"destination"},is=["onClick"],ls={class:"buttons"},rs=["onClick"],ds=["onClick"],as=["onClick"],us={key:0,class:"bulkManagement"},cs={class:"empty"};function ps(o,s,h,v,n,i){const l=z("font-awesome-icon"),C=E("observe-visibility");return d(),u("div",F,[e("div",P,[s[20]||(s[20]=e("div",{class:"title"},[e("h1",null,"Lynx")],-1)),e("div",q,[e("div",A,[r(l,{ref:"refreshButton",icon:["fas","arrows-rotate"],spinning:n.refreshSpinning,onClick:i.refresh},null,8,["spinning","onClick"])]),["owner","admin"].includes(n.account.account.role)?(d(),u("div",N,[e("div",O,[k(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>n.userFilterValue=t),ref:"userFilterInput",onFocus:s[1]||(s[1]=(...t)=>i.getUsers&&i.getUsers(...t)),"data-empty":n.userFilterValue===""},[s[17]||(s[17]=e("option",{value:""}," All users ",-1)),(d(!0),u(g,null,f(n.users,t=>(d(),u("option",{value:t.id,key:t.id},p(t.username),9,U))),128))],40,R),[[y,n.userFilterValue]])]),r(l,{icon:["fas","user"]})])):m("",!0),e("div",{class:"custom search",onClick:s[4]||(s[4]=M(t=>o.$refs.searchbox.focus(),["self"]))},[k(e("input",{ref:"searchbox","onUpdate:modelValue":s[2]||(s[2]=t=>n.search.value=t),type:"text",placeholder:"Search"},null,512),[[S,n.search.value]]),r(l,{icon:["fas","magnifying-glass"],onClick:s[3]||(s[3]=t=>o.$refs.searchbox.focus())})]),e("button",{onClick:s[5]||(s[5]=(...t)=>i.importLinks&&i.importLinks(...t))},[r(l,{icon:["fas","upload"]}),s[18]||(s[18]=e("span",null,"Import",-1))]),e("button",{onClick:s[6]||(s[6]=(...t)=>i.exportLinks&&i.exportLinks(...t))},[r(l,{icon:["fas","download"]}),s[19]||(s[19]=e("span",null,"Export",-1))]),e("button",{onClick:s[7]||(s[7]=t=>n.popups.addPopup("CreateLink",{}))}," Add Link ")]),e("div",Q,[e("p",{style:D(`--maxLength: ${Math.max(...Object.values(n.sortOptions).map(t=>t.length))}ch;`),onClick:s[9]||(s[9]=t=>o.$refs.mobileSort.click())},[c(p(n.sortOptions[n.links.sort.field])+" ",1),k(e("select",{ref:"mobileSort","onUpdate:modelValue":s[8]||(s[8]=t=>n.links.sort.field=t)},[(d(!0),u(g,null,f(n.sortOptions,(t,a)=>(d(),u("option",{key:a,value:a},p(t),9,_))),128))],512),[[y,n.links.sort.field]])],4),e("div",{class:"icon",sortType:n.links.sort.type,onClick:s[10]||(s[10]=t=>n.links.sort.type*=-1)},[r(l,{icon:["fas","sort-down"]})],8,j)])]),e("div",G,[e("table",null,[e("thead",null,[s[26]||(s[26]=e("th",null,null,-1)),e("th",null,[e("span",{sortType:n.links.sort.field=="author"?n.links.sort.type:0,onClick:s[11]||(s[11]=t=>i.toggleSort("author"))},[s[21]||(s[21]=c(" Author ")),r(l,{icon:["fas","sort-down"]})],8,J)]),e("th",null,[e("span",{sortType:n.links.sort.field=="creationDate"?n.links.sort.type:0,onClick:s[12]||(s[12]=t=>i.toggleSort("creationDate"))},[s[22]||(s[22]=c(" Created At ")),r(l,{icon:["fas","sort-down"]})],8,K)]),e("th",null,[e("span",{sortType:n.links.sort.field=="slug"?n.links.sort.type:0,onClick:s[13]||(s[13]=t=>i.toggleSort("slug"))},[s[23]||(s[23]=c(" Slug ")),r(l,{icon:["fas","sort-down"]})],8,W)]),e("th",null,[e("span",{sortType:n.links.sort.field=="destination"?n.links.sort.type:0,onClick:s[14]||(s[14]=t=>i.toggleSort("destination"))},[s[24]||(s[24]=c(" Destination ")),r(l,{icon:["fas","sort-down"]})],8,X)]),e("th",null,[e("span",{sortType:n.links.sort.field=="visits"?n.links.sort.type:0,onClick:s[15]||(s[15]=t=>i.toggleSort("visits"))},[s[25]||(s[25]=c(" Visits ")),r(l,{icon:["fas","sort-down"]})],8,Y)]),s[27]||(s[27]=e("th",null,null,-1))]),(d(!0),u(g,null,f(n.links.links,t=>(d(),u("tr",{key:t.id,class:"link"},[e("td",null,[e("div",{class:"checkbox",selected:n.links.selectedLinks.includes(t.id),onClick:a=>i.toggleSelection(t)},[n.links.selectedLinks.includes(t.id)?(d(),I(l,{key:0,icon:["fas","check"]})):m("",!0)],8,Z)]),e("td",$,[s[28]||(s[28]=e("strong",null,"Author: ",-1)),s[29]||(s[29]=c()),e("span",null,p(t.account),1)]),e("td",ss,[s[30]||(s[30]=e("strong",null,"Created: ",-1)),c(p(t.creationDate),1)]),e("td",es,[s[31]||(s[31]=e("strong",null,"Slug: ",-1)),e("span",null,[e("a",{href:`/${t.slug}`,target:"_blank"},p(t.slug),9,ts),e("span",{onClick:a=>i.copyLink(a,t.slug)},[r(l,{icon:["fas","copy"]})],8,ns)])]),e("td",os,[s[32]||(s[32]=e("strong",null,"Destination: ",-1)),e("span",null,p(t.destination),1)]),e("td",null,[s[33]||(s[33]=e("strong",null,"Visits: ",-1)),e("span",null,p(t.visits),1)]),e("td",{class:"menu",onClick:a=>i.showContextMenu(a,t)},[r(l,{icon:["fas","ellipsis-vertical"]})],8,is),e("td",ls,[e("button",{class:"button-edit",onClick:a=>i.handleEdit(t)},[r(l,{icon:["fas","pencil"]}),s[34]||(s[34]=e("span",null,"Edit",-1))],8,rs),e("button",{class:"button-delete",onClick:a=>i.handleDelete([t.id])},[r(l,{icon:["fas","trash-can"]}),s[35]||(s[35]=e("span",null,"Delete",-1))],8,ds),e("button",{class:"button-qrcode",onClick:a=>i.openQRCode(t)},[r(l,{icon:["fas","qrcode"]})],8,as)])]))),128)),n.links.selectedLinks.length>0?(d(),u("div",us,[e("button",{onClick:s[16]||(s[16]=t=>i.handleDelete(n.links.selectedLinks))},[r(l,{icon:["fas","trash-can"]}),s[36]||(s[36]=c(" Delete Selected Links "))])])):m("",!0)]),k((d(),u("p",cs,[c(p(n.links.remainingPages===0&&n.links.links.length===0?n.search.value?"No links match that search":"No links have currently been added.":""),1)])),[[C,i.visibilityChanged]])]),s[37]||(s[37]=T(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-v-8cd66363><symbol id="icon-trash-can" viewBox="0 0 448 512" data-v-8cd66363><path fill="currentColor" d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32\r
                    128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16\r
                    16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z" data-v-8cd66363></path></symbol></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-v-8cd66363><symbol id="icon-pencil" viewBox="0 0 512 512" data-v-8cd66363><path fill="currentColor" d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7\r
                    6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0\r
                    8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3\r
                    18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z" data-v-8cd66363></path></symbol></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-v-8cd66363><symbol id="icon-qr-code" viewBox="0 0 512 512" data-v-8cd66363><path fill="currentColor" d="M0 80C0 53.5 21.5 32 48 32h96c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80zM64 96v64h64V96H64zM0 336c0-26.5 21.5-48 48-48h96c26.5 0 48\r
                    21.5 48 48v96c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V336zm64 16v64h64V352H64zM304 32h96c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48H304c-26.5 0-48-21.5-48-48V80c0-26.5\r
                    21.5-48 48-48zm80 64H320v64h64V96zM256 304c0-8.8 7.2-16 16-16h64c8.8 0 16 7.2 16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s7.2-16 16-16s16 7.2 16 16v96c0 8.8-7.2 16-16 16H368c-8.8\r
                    0-16-7.2-16-16s-7.2-16-16-16s-16 7.2-16 16v64c0 8.8-7.2 16-16 16H272c-8.8 0-16-7.2-16-16V304zM368 480a16 16 0 1 1 0-32 16 16 0 1 1 0 32zm64 0a16 16 0 1 1 0-32 16 16 0 1 1 0 32z" data-v-8cd66363></path></symbol></svg>`,3))],512)}const ks=w(H,[["render",ps],["__scopeId","data-v-8cd66363"]]);export{ks as default};
